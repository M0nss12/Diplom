import{_ as I,c as r,a as t,i as d,A as P,F as C,e as _,t as a,j as U,k as u,v as m,q as B,T as N,u as A,y as w,o as F,B as T,h as i,d as q}from"./index-Z1tz7U2i.js";import{u as D}from"./useCrud-BTeG7eu8.js";const j={name:"ProductList",props:{maxPrice:{type:Number,default:0},categories:{type:Array,default:()=>[]},brands:{type:Array,default:()=>[]}},emits:["update:items"],setup(o,{emit:s}){const b=D("products"),{addToCart:p}=A(),f=T("filters"),v=async n=>{const l=n.target.files[0];if(!l)return;const g=new FormData;g.append("image",l);try{const y=localStorage.getItem("token"),h=await fetch("/api/upload",{method:"POST",headers:{Authorization:`Bearer ${y}`},body:g});if(h.ok){const V=await h.json();b.form.value.image_url=V.url}else alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ")}catch(y){console.error(y),alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ")}},e=n=>{const l=o.categories?.find(g=>g.id===n);return l?l.name:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},c=n=>{const l=o.brands?.find(g=>g.id===n);return l?l.name:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},M=()=>{const n={},l=f.value;return l&&(l.selectedCategory&&(n.category_id=l.selectedCategory),l.selectedBrand&&(n.brand_id=l.selectedBrand),l.hasDiscount===!0&&(n.has_discount=!0),l.priceMin>0&&(n.price_min=l.priceMin),l.priceMax&&l.priceMax<o.maxPrice&&(n.price_max=l.priceMax),l.sortValue&&(n.sort=l.sortValue)),n},k=async()=>{const n=M();b.page.value=1;const l=Object.keys(n).map(y=>`${encodeURIComponent(y)}=${encodeURIComponent(n[y])}`).join("&");let g="/api/products";l&&(g+=`?${l}`),await b.fetchItems(g),s("update:items",b.items.value)};w(f,k,{deep:!0}),w(()=>o.maxPrice,n=>{f.value&&f.value.priceMax===0&&(f.value.priceMax=n),k()},{immediate:!0});const $=n=>{const l={...n,price:Number(n.price)};p(l),alert(`–¢–æ–≤–∞—Ä "${n.name}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!`)};return F(()=>{f.value?k():b.fetchItems()}),{...b,sharedFilters:f,handleAddToCart:$,getCategoryName:e,getBrandName:c,handleFileUpload:v}}},S={class:"card p-4"},E={class:"header-actions"},L={key:0,class:"no-results-message"},R={key:0,class:"admin-table"},z={key:0},K=["src"],O={key:1},G={key:0,style:{"text-decoration":"line-through",color:"#999","font-size":"0.8em"}},H={class:"actions-cell"},J=["onClick"],Q=["onClick"],W=["onClick"],X=["onClick"],Y={key:1,class:"product-card-grid"},Z=["onClick"],x=["src"],tt={key:0,class:"discount-badge"},et={key:1,class:"featured-badge"},st={class:"card-body"},ot={class:"card-meta"},lt={class:"meta-item category"},nt={class:"meta-item brand"},it={class:"product-details-short"},rt={key:0},at={key:1},dt=["onClick"],ut={class:"card-price-section"},mt={class:"current-price"},pt={key:0,class:"old-price"},ct={class:"card-actions"},gt=["onClick"],ft=["disabled","onClick"],bt={key:2,class:"pagination mt-4"},yt=["disabled"],kt=["disabled"],vt={class:"modal-content card large-modal"},ht={class:"grid-2"},Ct={class:"form-group"},_t={class:"form-group"},Ut={class:"form-group"},wt={class:"form-group"},Mt={class:"form-group"},$t={class:"form-group"},Vt={class:"form-group"},It={class:"form-group"},Pt={class:"form-group"},Bt={class:"form-group"},Nt={key:0,class:"mt-2 text-center"},At=["src"],Ft={class:"form-group"},Tt={class:"form-group checkbox-group"},qt={class:"modal-actions"};function Dt(o,s,b,p,f,v){return i(),r("div",S,[t("div",E,[s[19]||(s[19]=t("h2",null,"–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤",-1)),o.paginatedItems.length===0?(i(),r("p",L," –¢–æ–≤–∞—Ä—ã –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. ")):d("",!0),o.isAdmin?(i(),r("button",{key:1,class:"btn btn-primary",onClick:s[0]||(s[0]=e=>o.openEditModal())},"+ –î–æ–±–∞–≤–∏—Ç—å")):d("",!0)]),o.isAdmin?(i(),r("table",R,[s[21]||(s[21]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"–§–æ—Ç–æ"),t("th",null,"–ù–∞–∑–≤–∞–Ω–∏–µ"),t("th",null,"–¶–µ–Ω–∞"),t("th",null,"–û—Å—Ç–∞—Ç–æ–∫"),t("th",null,"–í–µ—Å"),t("th",null,"–ê—Ä—Ç–∏–∫—É–ª (SKU)"),t("th",null,"–ö–∞—Ç–µ–≥–æ—Ä–∏—è"),t("th",null,"–ë—Ä–µ–Ω–¥"),t("th",null,"–¢–æ–ø?"),t("th",null,"–î–µ–π—Å—Ç–≤–∏—è")])],-1)),t("tbody",null,[o.items.length===0&&o.paginatedItems.length===0?(i(),r("tr",z,[...s[20]||(s[20]=[t("td",{colspan:"11",class:"text-center p-4"},"–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.",-1)])])):d("",!0),(i(!0),r(C,null,_(o.paginatedItems,e=>(i(),r("tr",{key:e.id},[t("td",null,a(e.id),1),t("td",null,[e.image_url?(i(),r("img",{key:0,src:e.image_url,style:{width:"80px",height:"80px","object-fit":"cover","border-radius":"4px"}},null,8,K)):(i(),r("span",O,"-"))]),t("td",null,a(e.name),1),t("td",null,[q(a(e.price)+" ‚ÇΩ ",1),e.old_price&&e.old_price>e.price?(i(),r("span",G,a(e.old_price),1)):d("",!0)]),t("td",null,a(e.quantity_in_stock),1),t("td",null,a(e.weight),1),t("td",null,a(e.sku||"-"),1),t("td",null,a(p.getCategoryName(e.category_id)),1),t("td",null,a(p.getBrandName(e.brand_id)),1),t("td",null,a(e.is_featured?"‚òÖ":""),1),t("td",H,[t("button",{class:"btn-sm cart-add",onClick:c=>p.handleAddToCart(e),title:"–í –∫–æ—Ä–∑–∏–Ω—É"},"üõí",8,J),t("button",{class:"btn-sm view",onClick:c=>o.$router.push(`/catalog/products/${e.id}`),title:"–ü—Ä–æ—Å–º–æ—Ç—Ä"},"üëÅÔ∏è",8,Q),t("button",{class:"btn-sm edit",onClick:c=>o.openEditModal(e),title:"–†–µ–¥"},"‚úèÔ∏è",8,W),t("button",{class:"btn-sm delete",onClick:c=>o.deleteItem(e.id),title:"–£–¥–∞–ª"},"üóëÔ∏è",8,X)])]))),128))])])):(i(),r("div",Y,[(i(!0),r(C,null,_(o.paginatedItems,e=>(i(),r("div",{class:"product-card",key:e.id},[t("div",{class:"card-image-wrapper",onClick:c=>o.$router.push(`/catalog/products/${e.id}`)},[t("img",{src:e.image_url||"/placeholder.jpg",alt:"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞",class:"card-image"},null,8,x),e.old_price&&e.old_price>e.price?(i(),r("span",tt,"–°–∫–∏–¥–∫–∞!")):d("",!0),e.is_featured?(i(),r("span",et,"–¢–æ–ø")):d("",!0)],8,Z),t("div",st,[t("div",ot,[t("span",lt,a(p.getCategoryName(e.category_id)),1),t("span",nt,a(p.getBrandName(e.brand_id)),1)]),t("div",it,[e.rating>0?(i(),r("span",rt,"‚≠ê "+a(e.rating),1)):d("",!0),e.weight>0?(i(),r("span",at,"| "+a(e.weight)+" –∫–≥",1)):d("",!0)]),t("h3",{class:"card-title",onClick:c=>o.$router.push(`/catalog/products/${e.id}`)},a(e.name),9,dt),t("div",ut,[t("span",mt,a(e.price)+" ‚ÇΩ",1),e.old_price&&e.old_price>e.price?(i(),r("span",pt,a(e.old_price)+" ‚ÇΩ",1)):d("",!0)])]),t("div",ct,[t("button",{class:"btn btn-outline btn-sm",onClick:c=>o.$router.push(`/catalog/products/${e.id}`),style:{width:"48%","margin-right":"4%"}}," –ü–æ–¥—Ä–æ–±–Ω–µ–µ ",8,gt),t("button",{class:"btn btn-primary btn-sm",disabled:e.quantity_in_stock<=0,onClick:c=>p.handleAddToCart(e),style:{width:"48%"}},a(e.quantity_in_stock>0?"–í –∫–æ—Ä–∑–∏–Ω—É":"–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏"),9,ft)])]))),128))])),o.totalPages>1?(i(),r("div",bt,[t("button",{class:"btn btn-outline",disabled:o.page===1,onClick:s[1]||(s[1]=(...e)=>o.prevPage&&o.prevPage(...e))},"–ù–∞–∑–∞–¥",8,yt),t("span",null,"–°—Ç—Ä. "+a(o.page)+" –∏–∑ "+a(o.totalPages),1),t("button",{class:"btn btn-outline",disabled:o.page===o.totalPages,onClick:s[2]||(s[2]=(...e)=>o.nextPage&&o.nextPage(...e))},"–í–ø–µ—Ä–µ–¥",8,kt)])):d("",!0),(i(),P(N,{to:"body"},[o.showEditModal?(i(),r("div",{key:0,class:"modal-overlay",onClick:s[18]||(s[18]=U((...e)=>o.closeModals&&o.closeModals(...e),["self"]))},[t("div",vt,[t("h3",null,a(o.isEdit?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä":"–°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä"),1),t("form",{onSubmit:s[17]||(s[17]=U((...e)=>o.saveItem&&o.saveItem(...e),["prevent"]))},[t("div",ht,[t("div",Ct,[s[22]||(s[22]=t("label",null,"–ù–∞–∑–≤–∞–Ω–∏–µ *",-1)),u(t("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>o.form.name=e),class:"form-input",required:""},null,512),[[m,o.form.name]])]),t("div",_t,[s[23]||(s[23]=t("label",null,"–ê—Ä—Ç–∏–∫—É–ª (SKU)",-1)),u(t("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>o.form.sku=e),class:"form-input"},null,512),[[m,o.form.sku]])]),t("div",Ut,[s[24]||(s[24]=t("label",null,"–¶–µ–Ω–∞ *",-1)),u(t("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>o.form.price=e),type:"number",step:"0.01",class:"form-input",required:""},null,512),[[m,o.form.price]])]),t("div",wt,[s[25]||(s[25]=t("label",null,"–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞",-1)),u(t("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>o.form.old_price=e),type:"number",step:"0.01",class:"form-input"},null,512),[[m,o.form.old_price]])]),t("div",Mt,[s[26]||(s[26]=t("label",null,"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",-1)),u(t("input",{"onUpdate:modelValue":s[7]||(s[7]=e=>o.form.quantity_in_stock=e),type:"number",class:"form-input"},null,512),[[m,o.form.quantity_in_stock]])]),t("div",$t,[s[27]||(s[27]=t("label",null,"–í–µ—Å (–∫–≥)",-1)),u(t("input",{"onUpdate:modelValue":s[8]||(s[8]=e=>o.form.weight=e),type:"number",step:"0.001",class:"form-input"},null,512),[[m,o.form.weight]])]),t("div",Vt,[s[28]||(s[28]=t("label",null,"–ö–∞—Ç–µ–≥–æ—Ä–∏—è ID",-1)),u(t("input",{"onUpdate:modelValue":s[9]||(s[9]=e=>o.form.category_id=e),type:"number",class:"form-input"},null,512),[[m,o.form.category_id]])]),t("div",It,[s[29]||(s[29]=t("label",null,"–ë—Ä–µ–Ω–¥ ID",-1)),u(t("input",{"onUpdate:modelValue":s[10]||(s[10]=e=>o.form.brand_id=e),type:"number",class:"form-input"},null,512),[[m,o.form.brand_id]])]),t("div",Pt,[s[30]||(s[30]=t("label",null,"–†–µ–π—Ç–∏–Ω–≥ (0-5)",-1)),u(t("input",{"onUpdate:modelValue":s[11]||(s[11]=e=>o.form.rating=e),type:"number",step:"0.1",max:"5",class:"form-input"},null,512),[[m,o.form.rating]])]),t("div",Bt,[s[31]||(s[31]=t("label",null,"–§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞",-1)),u(t("input",{"onUpdate:modelValue":s[12]||(s[12]=e=>o.form.image_url=e),class:"form-input mb-2",placeholder:"–í—Å—Ç–∞–≤—å—Ç–µ URL –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª"},null,512),[[m,o.form.image_url]]),t("input",{type:"file",onChange:s[13]||(s[13]=(...e)=>p.handleFileUpload&&p.handleFileUpload(...e)),class:"form-input",accept:"image/*"},null,32),o.form.image_url?(i(),r("div",Nt,[t("img",{src:o.form.image_url,style:{"max-height":"100px",border:"1px solid #ccc","border-radius":"4px"}},null,8,At)])):d("",!0)])]),t("div",Ft,[s[32]||(s[32]=t("label",null,"–û–ø–∏—Å–∞–Ω–∏–µ",-1)),u(t("textarea",{"onUpdate:modelValue":s[14]||(s[14]=e=>o.form.description=e),class:"form-textarea"},null,512),[[m,o.form.description]])]),t("div",Tt,[u(t("input",{type:"checkbox",id:"feat","onUpdate:modelValue":s[15]||(s[15]=e=>o.form.is_featured=e)},null,512),[[B,o.form.is_featured]]),s[33]||(s[33]=t("label",{for:"feat"},"–ü–æ–ø—É–ª—è—Ä–Ω—ã–π (Featured)",-1))]),t("div",qt,[t("button",{type:"button",class:"btn btn-outline",onClick:s[16]||(s[16]=(...e)=>o.closeModals&&o.closeModals(...e))},"–û—Ç–º–µ–Ω–∞"),s[34]||(s[34]=t("button",{type:"submit",class:"btn btn-primary"},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",-1))])],32)])])):d("",!0)]))])}const Et=I(j,[["render",Dt]]);export{Et as default};
