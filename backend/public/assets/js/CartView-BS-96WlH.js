import{_ as U,c as a,a as o,i as h,F as L,e as N,k as i,d as p,p as y,t as d,v as c,q as P,b as E,w as O,r as q,u as B,g as f,l as I,o as F,m as R,h as r}from"./index-Z1tz7U2i.js";const S=500,j={setup(){const{cartItems:b,removeFromCart:e,updateQuantity:V,totalCount:s,totalPrice:M,clearCart:x}=B(),g=f(null),t=f(!1),m=f(""),T=R(),C=f(!1),l=f({deliveryType:"pickup",paymentMethod:"ÐžÐ½Ð»Ð°Ð¹Ð½-Ð¿Ð»Ð°Ñ‚ÐµÐ¶",name:"",phone:"",email:"",address:"",comment:""}),D=I(()=>l.value.deliveryType==="delivery"?S:0),w=I(()=>!(!l.value.name||l.value.name.length<2||!l.value.phone||l.value.phone.length<5||!l.value.paymentMethod||l.value.deliveryType==="delivery"&&(!l.value.address||l.value.address.length<5)));return F(async()=>{const k=localStorage.getItem("user"),_=localStorage.getItem("token");if(k&&_)try{const n=JSON.parse(k);g.value=n,l.value.name=n.username||"",l.value.email=n.email||"";const u=await fetch("/api/auth/me",{headers:{Authorization:`Bearer ${_}`}});if(u.ok){const v=await u.json();v.phone&&(l.value.phone=v.phone),v.address&&(l.value.address=v.address),(!v.phone||!v.address)&&(C.value=!0)}}catch(n){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ",n)}}),{cartItems:b,removeFromCart:e,updateQuantity:V,totalCount:s,totalPrice:M,user:g,createOrder:async()=>{if(m.value="",!w.value){m.value="ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð·Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ (Ð˜Ð¼Ñ, Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½, ÐÐ´Ñ€ÐµÑ Ð¿Ñ€Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐµ).";return}t.value=!0;const k=localStorage.getItem("token"),_={delivery_address:l.value.deliveryType==="delivery"?l.value.address:"Ð¡Ð°Ð¼Ð¾Ð²Ñ‹Ð²Ð¾Ð·: Ð³. ÐœÐ¾ÑÐºÐ²Ð°, ÑƒÐ». ÐŸÑ€Ð¸Ð¼ÐµÑ€Ð½Ð°Ñ, Ð´. 1",recipient_name:l.value.name,recipient_phone:l.value.phone,payment_method:l.value.paymentMethod,user_comment:l.value.comment,shipping_cost:D.value,address:l.value.address};try{const n=await fetch("/api/orders/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify({cartItems:b.value,orderDetails:_,saveDetails:C.value})}),u=await n.json();if(!n.ok)throw new Error(u.error||u.message||"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·");alert(`ðŸŽ‰ Ð—Ð°ÐºÐ°Ð· #${u.orderId} ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½!
Ð’Ð°Ñˆ Ñ‚Ñ€ÐµÐºÐ¸Ð½Ð³-Ð½Ð¾Ð¼ÐµÑ€: ${u.trackingNumber}`),x(),T.push("/my-orders")}catch(n){console.error(n),m.value=n.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ð·Ð°ÐºÐ°Ð·Ð°"}finally{t.value=!1}},form:l,shippingCost:D,isLoading:t,errorMsg:m,saveDetails:C,SHIPPING_DELIVERY:S}}},z={class:"container animate-fade-in",style:{"margin-top":"2rem","margin-bottom":"4rem"}},Q={key:0,class:"text-center p-8 card"},A={key:1,class:"cart-layout"},G={class:"cart-left-column"},H={class:"cart-items-list mb-6"},J={class:"item-img-wrapper"},Y=["src"],K={class:"item-info"},W={class:"price-single"},X={class:"item-controls"},Z=["onClick"],$={class:"qty-val"},ee=["onClick"],oe={class:"item-total-price"},se=["onClick"],te={key:0,class:"card p-6"},le={class:"form-group"},ae={class:"delivery-options"},re={class:"radio-label"},ne={class:"radio-label"},ie={class:"grid-2"},de={class:"form-group"},me={class:"form-group"},ue={class:"form-group"},ve={key:0,class:"animate-fade-in"},pe={class:"form-group"},ye={class:"form-group"},ce={class:"form-group checkbox-group mt-4",style:{background:"none",padding:"0"}},fe={key:1,class:"card p-6 mt-4"},be={class:"delivery-options"},ge={class:"radio-label"},ke={class:"radio-label"},_e={class:"radio-label"},he={class:"cart-summary card"},Ce={class:"summary-line"},Ve={class:"summary-line"},Me={key:0,style:{color:"var(--secondary)"}},xe={key:1},De={class:"summary-total"},Ie={key:0,class:"mt-4"},Se=["disabled"],Te={key:0,class:"message error mt-2"},we={key:1,class:"text-center mt-4"};function Ue(b,e,V,s,M,x){const g=q("router-link");return r(),a("div",z,[e[39]||(e[39]=o("h1",null,"ðŸ›’ ÐžÑ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð·Ð°",-1)),s.cartItems.length===0?(r(),a("div",Q,[e[13]||(e[13]=o("div",{style:{"font-size":"3rem","margin-bottom":"1rem"}},"ðŸ›ï¸",-1)),e[14]||(e[14]=o("p",null,"Ð’Ð°ÑˆÐ° ÐºÐ¾Ñ€Ð·Ð¸Ð½Ð° Ð¿ÑƒÑÑ‚Ð°.",-1)),o("button",{onClick:e[0]||(e[0]=t=>b.$router.push("/")),class:"btn btn-primary mt-4"},"ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ð² ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³")])):(r(),a("div",A,[o("div",G,[o("div",H,[(r(!0),a(L,null,N(s.cartItems,t=>(r(),a("div",{key:t.id,class:"cart-item"},[o("div",J,[o("img",{src:t.image_url||"https://via.placeholder.com/100",alt:"Ð¢Ð¾Ð²Ð°Ñ€"},null,8,Y)]),o("div",K,[o("h3",null,d(t.name),1),o("p",W,d(t.price.toLocaleString())+" â‚½",1)]),o("div",X,[o("button",{class:"qty-btn",onClick:m=>s.updateQuantity(t.id,-1)},"âˆ’",8,Z),o("span",$,d(t.quantity),1),o("button",{class:"qty-btn",onClick:m=>s.updateQuantity(t.id,1)},"+",8,ee)]),o("div",oe,d((t.price*t.quantity).toLocaleString())+" â‚½ ",1),o("button",{class:"remove-btn",onClick:m=>s.removeFromCart(t.id)},"âœ•",8,se)]))),128))]),s.user?(r(),a("div",te,[e[25]||(e[25]=o("h2",{class:"mb-4"},"ðŸ“‹ Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»Ñ",-1)),o("div",le,[e[18]||(e[18]=o("label",{class:"form-label"},"Ð¡Ð¿Ð¾ÑÐ¾Ð± Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ",-1)),o("div",ae,[o("label",re,[i(o("input",{type:"radio",value:"pickup","onUpdate:modelValue":e[1]||(e[1]=t=>s.form.deliveryType=t)},null,512),[[y,s.form.deliveryType]]),e[15]||(e[15]=o("span",{class:"radio-custom"},null,-1)),e[16]||(e[16]=p(" ðŸƒ Ð¡Ð°Ð¼Ð¾Ð²Ñ‹Ð²Ð¾Ð· (Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾) ",-1))]),o("label",ne,[i(o("input",{type:"radio",value:"delivery","onUpdate:modelValue":e[2]||(e[2]=t=>s.form.deliveryType=t)},null,512),[[y,s.form.deliveryType]]),e[17]||(e[17]=o("span",{class:"radio-custom"},null,-1)),p(" ðŸšš Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° ÐºÑƒÑ€ÑŒÐµÑ€Ð¾Ð¼ ("+d(s.SHIPPING_DELIVERY)+" â‚½) ",1)])])]),o("div",ie,[o("div",de,[e[19]||(e[19]=o("label",{class:"form-label"},"Ð˜Ð¼Ñ",-1)),i(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.form.name=t),class:"form-input",placeholder:"Ð’Ð°ÑˆÐµ Ð¸Ð¼Ñ"},null,512),[[c,s.form.name]])]),o("div",me,[e[20]||(e[20]=o("label",{class:"form-label"},"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½",-1)),i(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.form.phone=t),class:"form-input",placeholder:"+7 (999) 000-00-00"},null,512),[[c,s.form.phone]])])]),o("div",ue,[e[21]||(e[21]=o("label",{class:"form-label"},"Email",-1)),i(o("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>s.form.email=t),type:"email",class:"form-input",placeholder:"example@mail.ru",disabled:""},null,512),[[c,s.form.email]])]),s.form.deliveryType==="delivery"?(r(),a("div",ve,[o("div",pe,[e[22]||(e[22]=o("label",{class:"form-label"},"ÐÐ´Ñ€ÐµÑ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸",-1)),i(o("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>s.form.address=t),class:"form-input",placeholder:"Ð“Ð¾Ñ€Ð¾Ð´, ÑƒÐ»Ð¸Ñ†Ð°, Ð´Ð¾Ð¼, ÐºÐ²Ð°Ñ€Ñ‚Ð¸Ñ€Ð°"},null,512),[[c,s.form.address]])])])):h("",!0),o("div",ye,[e[23]||(e[23]=o("label",{class:"form-label"},"ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹",-1)),i(o("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.form.comment=t),class:"form-textarea",placeholder:"ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ ÐºÑƒÑ€ÑŒÐµÑ€Ñƒ, ÐºÐ¾Ð´ Ð´Ð¾Ð¼Ð¾Ñ„Ð¾Ð½Ð°, ÑÑ‚Ð°Ð¶..."},null,512),[[c,s.form.comment]])]),o("div",ce,[i(o("input",{type:"checkbox",id:"saveDetails","onUpdate:modelValue":e[8]||(e[8]=t=>s.saveDetails=t)},null,512),[[P,s.saveDetails]]),e[24]||(e[24]=o("label",{for:"saveDetails",style:{cursor:"pointer","user-select":"none"}}," Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¼Ð¾Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ (Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½ Ð¸ Ð°Ð´Ñ€ÐµÑ) Ð´Ð»Ñ Ð±ÑƒÐ´ÑƒÑ‰Ð¸Ñ… Ð·Ð°ÐºÐ°Ð·Ð¾Ð² ",-1))])])):h("",!0),s.user?(r(),a("div",fe,[e[32]||(e[32]=o("h2",{class:"mb-4"},"ðŸ’³ Ð¡Ð¿Ð¾ÑÐ¾Ð± Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹",-1)),o("div",be,[o("label",ge,[i(o("input",{type:"radio",value:"ÐžÐ½Ð»Ð°Ð¹Ð½-Ð¿Ð»Ð°Ñ‚ÐµÐ¶","onUpdate:modelValue":e[9]||(e[9]=t=>s.form.paymentMethod=t)},null,512),[[y,s.form.paymentMethod]]),e[26]||(e[26]=o("span",{class:"radio-custom"},null,-1)),e[27]||(e[27]=p(" ÐžÐ½Ð»Ð°Ð¹Ð½-Ð¿Ð»Ð°Ñ‚ÐµÐ¶ (ÐšÐ°Ñ€Ñ‚Ð¾Ð¹ Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ) ",-1))]),o("label",ke,[i(o("input",{type:"radio",value:"ÐžÐ¿Ð»Ð°Ñ‚Ð° ÐºÐ°Ñ€Ñ‚Ð¾Ð¹","onUpdate:modelValue":e[10]||(e[10]=t=>s.form.paymentMethod=t)},null,512),[[y,s.form.paymentMethod]]),e[28]||(e[28]=o("span",{class:"radio-custom"},null,-1)),e[29]||(e[29]=p(" ÐžÐ¿Ð»Ð°Ñ‚Ð° ÐºÐ°Ñ€Ñ‚Ð¾Ð¹ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ð¸ ",-1))]),o("label",_e,[i(o("input",{type:"radio",value:"ÐÐ°Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼Ð¸","onUpdate:modelValue":e[11]||(e[11]=t=>s.form.paymentMethod=t)},null,512),[[y,s.form.paymentMethod]]),e[30]||(e[30]=o("span",{class:"radio-custom"},null,-1)),e[31]||(e[31]=p(" ÐÐ°Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼Ð¸ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ð¸ ",-1))])])])):h("",!0)]),o("div",he,[e[37]||(e[37]=o("h2",null,"Ð˜Ñ‚Ð¾Ð³Ð¾",-1)),o("div",Ce,[o("span",null,"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ ("+d(s.totalCount)+")",1),o("span",null,d(s.totalPrice.toLocaleString())+" â‚½",1)]),o("div",Ve,[e[33]||(e[33]=o("span",null,"Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°",-1)),s.form.deliveryType==="pickup"?(r(),a("span",Me,"0 â‚½")):(r(),a("span",xe,d(s.shippingCost.toLocaleString())+" â‚½",1))]),e[38]||(e[38]=o("div",{class:"divider"},null,-1)),o("div",De,[e[34]||(e[34]=o("span",null,"Ð’ÑÐµÐ³Ð¾:",-1)),o("span",null,d((s.totalPrice+s.shippingCost).toLocaleString())+" â‚½",1)]),s.user?(r(),a("div",Ie,[o("button",{onClick:e[12]||(e[12]=(...t)=>s.createOrder&&s.createOrder(...t)),class:"btn btn-primary w-100 pay-btn",disabled:s.isLoading},d(s.isLoading?"Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ...":"ðŸ“ ÐžÑ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·"),9,Se),s.errorMsg?(r(),a("div",Te,d(s.errorMsg),1)):h("",!0)])):(r(),a("div",we,[e[36]||(e[36]=o("p",{class:"mb-2 text-sm",style:{color:"var(--danger)"}},"Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·",-1)),E(g,{to:"/login",class:"btn btn-outline w-100"},{default:O(()=>[...e[35]||(e[35]=[p("Ð’Ð¾Ð¹Ñ‚Ð¸",-1)])]),_:1})]))])]))])}const Pe=U(j,[["render",Ue]]);export{Pe as default};
