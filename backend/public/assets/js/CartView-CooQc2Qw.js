import{_ as S,c as a,a as o,f as _,F as U,r as I,g as d,h as C,m as V,v as m,p as L,t as n,i as M,j as O,k as q,u as N,d as u,q as B,o as E,l as F,e as r}from"./index-BS7-ax_o.js";const P={setup(){const{cartItems:v,removeFromCart:e,updateQuantity:h,totalCount:s,totalPrice:x,clearCart:T}=N(),c=u(null),t=u(!1),i=u(""),w=F(),b=u(!1),l=u({deliveryType:"pickup",name:"",phone:"",email:"",address:"",comment:""}),D=B(()=>l.value.deliveryType==="delivery"?500:0);return E(async()=>{const p=localStorage.getItem("user"),y=localStorage.getItem("token");if(p&&y){const k=JSON.parse(p);c.value=k,l.value.name=k.username||"",l.value.email=k.email||"";try{const f=await fetch("/api/auth/me",{headers:{Authorization:`Bearer ${y}`}});if(f.ok){const g=await f.json();l.value.phone=g.phone||"",l.value.address=g.address||"",(!g.phone||!g.address)&&(b.value=!0)}}catch(f){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ",f)}}}),{cartItems:v,removeFromCart:e,updateQuantity:h,totalCount:s,totalPrice:x,user:c,createOrder:async()=>{if(!l.value.name||!l.value.phone||!l.value.email){i.value="Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ (Ð˜Ð¼Ñ, Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½, Email)";return}if(l.value.deliveryType==="delivery"&&!l.value.address){i.value="Ð£ÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð°Ð´Ñ€ÐµÑ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸";return}t.value=!0,i.value="";const p=localStorage.getItem("token");try{if(!(await fetch("/api/orders/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({cartItems:v.value,orderDetails:{...l.value},saveDetails:b.value})})).ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ");T(),w.push("/my-orders")}catch{i.value="ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ð·Ð°ÐºÐ°Ð·Ð°"}finally{t.value=!1}},form:l,shippingCost:D,isLoading:t,errorMsg:i,saveDetails:b}}},j={class:"container animate-fade-in",style:{"margin-top":"2rem","margin-bottom":"4rem"}},z={key:0,class:"text-center p-8 card"},Q={key:1,class:"cart-layout"},A={class:"cart-left-column"},J={class:"cart-items-list mb-6"},R={class:"item-img-wrapper"},G=["src"],H={class:"item-info"},K={class:"price-single"},W={class:"item-controls"},X=["onClick"],Y={class:"qty-val"},Z=["onClick"],$={class:"item-total-price"},ee=["onClick"],oe={key:0,class:"card p-6"},se={class:"form-group"},te={class:"delivery-options"},le={class:"radio-label"},ae={class:"radio-label"},re={class:"grid-2"},ne={class:"form-group"},ie={class:"form-group"},de={class:"form-group"},me={key:0,class:"animate-fade-in"},ue={class:"form-group"},ve={class:"form-group"},ce={class:"form-group checkbox-group mt-4",style:{background:"none",padding:"0"}},pe={class:"cart-summary card"},ye={class:"summary-line"},fe={class:"summary-line"},ge={key:0,style:{color:"var(--secondary)"}},be={key:1},ke={class:"summary-total"},_e={key:0,class:"mt-4"},Ce=["disabled"],he={key:0,class:"message error mt-2"},xe={key:1,class:"text-center mt-4"};function Te(v,e,h,s,x,T){const c=q("router-link");return r(),a("div",j,[e[30]||(e[30]=o("h1",null,"ðŸ›’ ÐžÑ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÐ°Ð·Ð°",-1)),s.cartItems.length===0?(r(),a("div",z,[e[10]||(e[10]=o("div",{style:{"font-size":"3rem","margin-bottom":"1rem"}},"ðŸ›ï¸",-1)),e[11]||(e[11]=o("p",null,"Ð’Ð°ÑˆÐ° ÐºÐ¾Ñ€Ð·Ð¸Ð½Ð° Ð¿ÑƒÑÑ‚Ð°.",-1)),o("button",{onClick:e[0]||(e[0]=t=>v.$router.push("/")),class:"btn btn-primary mt-4"},"ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ð² ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³")])):(r(),a("div",Q,[o("div",A,[o("div",J,[(r(!0),a(U,null,I(s.cartItems,t=>(r(),a("div",{key:t.id,class:"cart-item"},[o("div",R,[o("img",{src:t.image_url||"https://via.placeholder.com/100",alt:"Ð¢Ð¾Ð²Ð°Ñ€"},null,8,G)]),o("div",H,[o("h3",null,n(t.name),1),o("p",K,n(t.price.toLocaleString())+" â‚½",1)]),o("div",W,[o("button",{class:"qty-btn",onClick:i=>s.updateQuantity(t.id,-1)},"âˆ’",8,X),o("span",Y,n(t.quantity),1),o("button",{class:"qty-btn",onClick:i=>s.updateQuantity(t.id,1)},"+",8,Z)]),o("div",$,n((t.price*t.quantity).toLocaleString())+" â‚½ ",1),o("button",{class:"remove-btn",onClick:i=>s.removeFromCart(t.id)},"âœ•",8,ee)]))),128))]),s.user?(r(),a("div",oe,[e[23]||(e[23]=o("h2",{class:"mb-4"},"ðŸ“‹ Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»Ñ",-1)),o("div",se,[e[16]||(e[16]=o("label",{class:"form-label"},"Ð¡Ð¿Ð¾ÑÐ¾Ð± Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ",-1)),o("div",te,[o("label",le,[d(o("input",{type:"radio",value:"pickup","onUpdate:modelValue":e[1]||(e[1]=t=>s.form.deliveryType=t)},null,512),[[V,s.form.deliveryType]]),e[12]||(e[12]=o("span",{class:"radio-custom"},null,-1)),e[13]||(e[13]=C(" ðŸƒ Ð¡Ð°Ð¼Ð¾Ð²Ñ‹Ð²Ð¾Ð· (Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾) ",-1))]),o("label",ae,[d(o("input",{type:"radio",value:"delivery","onUpdate:modelValue":e[2]||(e[2]=t=>s.form.deliveryType=t)},null,512),[[V,s.form.deliveryType]]),e[14]||(e[14]=o("span",{class:"radio-custom"},null,-1)),e[15]||(e[15]=C(" ðŸšš Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ° ÐºÑƒÑ€ÑŒÐµÑ€Ð¾Ð¼ (500 â‚½) ",-1))])])]),o("div",re,[o("div",ne,[e[17]||(e[17]=o("label",{class:"form-label"},"Ð˜Ð¼Ñ",-1)),d(o("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.form.name=t),class:"form-input",placeholder:"Ð’Ð°ÑˆÐµ Ð¸Ð¼Ñ"},null,512),[[m,s.form.name]])]),o("div",ie,[e[18]||(e[18]=o("label",{class:"form-label"},"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½",-1)),d(o("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.form.phone=t),class:"form-input",placeholder:"+7 (999) 000-00-00"},null,512),[[m,s.form.phone]])])]),o("div",de,[e[19]||(e[19]=o("label",{class:"form-label"},"Email",-1)),d(o("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>s.form.email=t),type:"email",class:"form-input",placeholder:"example@mail.ru"},null,512),[[m,s.form.email]])]),s.form.deliveryType==="delivery"?(r(),a("div",me,[o("div",ue,[e[20]||(e[20]=o("label",{class:"form-label"},"ÐÐ´Ñ€ÐµÑ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸",-1)),d(o("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>s.form.address=t),class:"form-input",placeholder:"Ð“Ð¾Ñ€Ð¾Ð´, ÑƒÐ»Ð¸Ñ†Ð°, Ð´Ð¾Ð¼, ÐºÐ²Ð°Ñ€Ñ‚Ð¸Ñ€Ð°"},null,512),[[m,s.form.address]])]),o("div",ve,[e[21]||(e[21]=o("label",{class:"form-label"},"ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ ÐºÑƒÑ€ÑŒÐµÑ€Ñƒ",-1)),d(o("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.form.comment=t),class:"form-textarea",placeholder:"ÐšÐ¾Ð´ Ð´Ð¾Ð¼Ð¾Ñ„Ð¾Ð½Ð°, ÑÑ‚Ð°Ð¶..."},null,512),[[m,s.form.comment]])])])):_("",!0),o("div",ce,[d(o("input",{type:"checkbox",id:"saveDetails","onUpdate:modelValue":e[8]||(e[8]=t=>s.saveDetails=t)},null,512),[[L,s.saveDetails]]),e[22]||(e[22]=o("label",{for:"saveDetails",style:{cursor:"pointer","user-select":"none"}}," Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¼Ð¾Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ (Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½ Ð¸ Ð°Ð´Ñ€ÐµÑ) Ð´Ð»Ñ Ð±ÑƒÐ´ÑƒÑ‰Ð¸Ñ… Ð·Ð°ÐºÐ°Ð·Ð¾Ð² ",-1))])])):_("",!0)]),o("div",pe,[e[28]||(e[28]=o("h2",null,"Ð˜Ñ‚Ð¾Ð³Ð¾",-1)),o("div",ye,[o("span",null,"Ð¢Ð¾Ð²Ð°Ñ€Ñ‹ ("+n(s.totalCount)+")",1),o("span",null,n(s.totalPrice.toLocaleString())+" â‚½",1)]),o("div",fe,[e[24]||(e[24]=o("span",null,"Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°",-1)),s.form.deliveryType==="pickup"?(r(),a("span",ge,"0 â‚½")):(r(),a("span",be,n(s.shippingCost)+" â‚½",1))]),e[29]||(e[29]=o("div",{class:"divider"},null,-1)),o("div",ke,[e[25]||(e[25]=o("span",null,"Ð’ÑÐµÐ³Ð¾:",-1)),o("span",null,n((s.totalPrice+s.shippingCost).toLocaleString())+" â‚½",1)]),s.user?(r(),a("div",_e,[o("button",{onClick:e[9]||(e[9]=(...t)=>s.createOrder&&s.createOrder(...t)),class:"btn btn-primary w-100 pay-btn",disabled:s.isLoading},n(s.isLoading?"Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ...":"ðŸ“ ÐžÑ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·"),9,Ce),s.errorMsg?(r(),a("div",he,n(s.errorMsg),1)):_("",!0)])):(r(),a("div",xe,[e[27]||(e[27]=o("p",{class:"mb-2 text-sm",style:{color:"var(--danger)"}},"Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·",-1)),M(c,{to:"/login",class:"btn btn-outline w-100"},{default:O(()=>[...e[26]||(e[26]=[C("Ð’Ð¾Ð¹Ñ‚Ð¸",-1)])]),_:1})]))])]))])}const De=S(P,[["render",Te],["__scopeId","data-v-32172c3d"]]);export{De as default};
